(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{591:function(t,e,a){"use strict";a.r(e);var r=a(8),n=a.n(r),c=a(67),o=a(52);function i(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var a=this;this.el=e;var r=document.querySelectorAll(".ajaxGETproduct"),n=document.querySelector(".cart");document.querySelector(".cart_content")&&this._createMagicBtn(),n&&(this._setDeleteListeners(),this._setAmountListeners(),r.forEach((function(t){t.addEventListener("click",(function(t){a.addToCart(t)}))})))}var e,a,r;return e=t,(a=[{key:"_createMagicBtn",value:function(){var t=document.querySelector(".magic_btn");new o.a(t)}},{key:"_pushToOrderProcess",value:function(){c.a.push("/checkoutProducts")}},{key:"_fixCartTotalState",value:function(){var t=window.location.origin+"/checkCartState",e=document.querySelector("[data-cartamountval]"),a=document.querySelectorAll("[data-cartpriceval]");n.a.ajax({method:"get",url:"".concat(t),success:function(t){e.innerText=t.totalQuantity,a.forEach((function(e){return e.innerText=t.totalPrice}))},error:function(t){console.warn(t)}})}},{key:"_changeConcreteItem",value:function(t){document.querySelectorAll(".cart_item_row").forEach((function(e){var a=parseInt(e.getAttribute("data-id"));if(t.data.id===a){var r=e.querySelector(".cart_wrap-item_inner-table_row-col_total");e.querySelector(".cart_wrap-item_inner-table_row-col_btns-btn-items_quantity").innerText=t.quantity,r.innerText=t.totalPrice}}))}},{key:"_findItemInCart",value:function(t,e){for(var a,r=parseInt(e.getAttribute("data-prid")),n=t.items,c=0,o=Object.values(n);c<o.length;c++){var i=o[c];i.data.id===r&&(a=i)}return a}},{key:"_setAmountListeners",value:function(){var t=this;document.querySelectorAll(".cart_wrap-item_inner-table_row-col_btns-btn-items").forEach((function(e){e.querySelectorAll("a").forEach((function(e){e.addEventListener("click",(function(a){var r=a.currentTarget.getAttribute("href");a.preventDefault(),n.a.ajax({method:"get",url:"".concat(r),success:function(a){var r=t._findItemInCart(a,e);t._changeConcreteItem(r),t._fixCartTotalState()},error:function(t){console.warn(t)}})}))}))}))}},{key:"_setDeleteListeners",value:function(){var t=this,e=document.querySelectorAll(".remove_icon");e&&e.forEach((function(a,r){a.addEventListener("click",(function(){t._deleteFromCart(e[r],a)}))}))}},{key:"_deleteFromCart",value:function(t){var e=t.getAttribute("data-href"),a=n()('input[name="_token"]').val(),r=this;n.a.ajax({method:"GET",url:e,data:{token:a},success:function(t){if(n()(t).hasClass("empty_cart")){var e=n()(".cart_wrap");n()(e).html(t),r._fixDeletion("","","addClass")}else{var a=n()(t).find(".cart_wrap-item_inner-table"),c=a[0].dataset.cartprice,o=a[0].dataset.cartamount,i=n()(".cart_content");n()(i).html(n()(t)[0]),r._fixDeletion(o,c),r._setDeleteListeners()}},error:function(t){console.warn(t)}})}},{key:"_fixDeletion",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n()("[data-cartamountval]").html(t),n()("[data-cartpriceval]").html(e),0!=a?(n()("[data-cartIcon]").attr("src","/images/menu/empty_cart.svg"),n()(".menu_wrapper-item_cart_currency").addClass("invisible")):n()(".menu_wrapper-item_cart_currency").removeClass("invisible")}},{key:"addToCart",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;t.preventDefault();var a=this,r=t.currentTarget.getAttribute("data-url"),c=!1;c||(c=!0,n.a.ajax({method:"GET",url:r,data:{token:window.token,amount:e},success:function(t){a._fixDeletion(t.totalQuantity,t.totalPrice)},error:function(t){console.warn(t)}}))}}])&&i(e.prototype,a),r&&i(e,r),t}();e.default=u}}]);